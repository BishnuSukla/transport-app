{"ast":null,"code":"var _jsxFileName = \"/Users/bishnusukla/Documents/transportApp/v1/src/components/search/search.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from 'react';\nimport './search.scss';\nimport PlacesAutocomplete, { geocodeByAddress, geocodeByPlaceId, getLatLng } from 'react-places-autocomplete';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst apiKey = process.env.REACT_APP_GOOGLE_LOC_API_KEY;\nconst mapApiJs = 'https://maps.googleapis.com/maps/api/js';\nconst geocodeJson = 'https://maps.googleapis.com/maps/api/geocode/json';\nlet sessionToken = '';\n// load google map api js\n\nfunction loadAsyncScript(src) {\n  return new Promise(resolve => {\n    const script = document.createElement(\"script\");\n    Object.assign(script, {\n      type: \"text/javascript\",\n      async: true,\n      src\n    });\n    script.addEventListener(\"load\", () => resolve(script));\n    document.head.appendChild(script);\n  });\n}\n\n// const extractAddress = (place) => {\n\n//   const address = {\n//     city: \"\",\n//     state: \"\",\n//     zip: \"\",\n//     country: \"\",\n//     plain() {\n//       const city = this.city ? this.city + \", \" : \"\";\n//       const zip = this.zip ? this.zip + \", \" : \"\";\n//       const state = this.state ? this.state + \", \" : \"\";\n//       return city + zip + state + this.country;\n//     }\n//   }\n\n//   if (!Array.isArray(place?.address_components)) {\n//     return address;\n//   }\n\n//   place.address_components.forEach(component => {\n//     const types = component.types;\n//     const value = component.long_name;\n\n//     if (types.includes(\"locality\")) {\n//       address.city = value;\n//     }\n\n//     if (types.includes(\"administrative_area_level_2\")) {\n//       address.state = value;\n//     }\n\n//     if (types.includes(\"postal_code\")) {\n//       address.zip = value;\n//     }\n\n//     if (types.includes(\"country\")) {\n//       address.country = value;\n//     }\n\n//   });\n\n//   return address;\n// }\n\nfunction Search() {\n  _s();\n  //   const searchInput = useRef(null);\n  //   const [address, setAddress] = useState({});\n\n  //   // init gmap script\n  const initMapScript = () => {\n    // if script already loaded\n    if (window.google) {\n      return Promise.resolve();\n    }\n    const src = `${mapApiJs}?key=${apiKey}&libraries=places&v=weekly&language=en&token=${sessionToken}&sessionToken=${sessionToken}&sessiontoken=${sessionToken}`;\n    return loadAsyncScript(src);\n  };\n\n  //   // do something on address change\n  //   const onChangeAddress = (autocomplete) => {\n  //     const place = autocomplete.getPlace();\n  //     setAddress(extractAddress(place));\n  //   }\n\n  //   // init autocomplete\n  //   const initAutocomplete = () => {\n  //     if (!searchInput.current) return;\n\n  //     const autocomplete = new window.google.maps.places.Autocomplete(searchInput.current);\n  //     autocomplete.setFields([\"address_component\", \"geometry\"]);\n  //     autocomplete.addListener(\"place_changed\", () => onChangeAddress(autocomplete));\n\n  //   }\n\n  //   const reverseGeocode = ({ latitude: lat, longitude: lng}) => {\n  //     const url = `${geocodeJson}?key=${apiKey}&latlng=${lat},${lng}`;\n  //     searchInput.current.value = \"Getting your location...\";\n  //     fetch(url)\n  //         .then(response => response.json())\n  //         .then(location => {\n  //           const place = location.results[0];\n  //           const _address = extractAddress(place);\n  //           setAddress(_address);\n  //           searchInput.current.value = _address.plain();\n  //         })\n  //   }\n\n  //   const findMyLocation = () => {\n  //     if (navigator.geolocation) {\n  //       navigator.geolocation.getCurrentPosition(position => {\n  //         reverseGeocode(position.coords)\n  //       })\n  //     }\n  //   }\n\n  // load map script after mounted\n  useEffect(() => {\n    initMapScript().then(() => {\n      setMapScriptLoaded(true);\n      console.log(\"google\", window.google);\n      sessionToken = new window.google.maps.places.AutocompleteSessionToken();\n      console.log(sessionToken);\n    });\n  }, []);\n  const [address, setAddress] = useState(\"\");\n  const [coordinates, setCoordinates] = useState({\n    lat: null,\n    lng: null\n  });\n  const [mapScriptLoaded, setMapScriptLoaded] = useState(false);\n  const handleSelect = async value => {\n    sessionToken = new window.google.maps.places.AutocompleteSessionToken();\n    setAddress(value);\n    const result = await geocodeByAddress(value);\n    const latLng = await getLatLng(result[0]);\n    console.log(result[0]);\n    setCoordinates(latLng);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: mapScriptLoaded && /*#__PURE__*/_jsxDEV(PlacesAutocomplete, {\n      value: address,\n      onChange: setAddress,\n      onSelect: handleSelect,\n      searchOptions: {\n        componentRestrictions: {\n          country: ['IN']\n        }\n      },\n      children: _ref => {\n        let {\n          getInputProps,\n          suggestions,\n          getSuggestionItemProps,\n          loading,\n          sessionToken,\n          refreshSessionToken\n        } = _ref;\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            ...getInputProps({\n              placeholder: \"Type here\"\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 163,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n              children: \"...loading\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 166,\n              columnNumber: 38\n            }, this) : null, suggestions.map(suggestion => {\n              const style = {\n                backgroundColor: suggestion.active ? \"#41b6e6\" : \"#fff\"\n              };\n              return /*#__PURE__*/_jsxDEV(\"div\", {\n                ...getSuggestionItemProps(suggestion, {\n                  style\n                }),\n                children: suggestion.description\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 172,\n                columnNumber: 40\n              }, this);\n            })]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 165,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 21\n        }, this);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 157,\n    columnNumber: 7\n  }, this)\n  // <div className=\"App\">\n  //   <div>\n  //     <div className=\"search\">\n  //       <span>S</span>\n  //       <input ref={searchInput} type=\"text\" placeholder=\"Search location....\"/>\n  //       <button onClick={findMyLocation}>L</button>\n  //     </div>\n\n  //     <div className=\"address\">\n  //       <p>City: <span>{address.city}</span></p>\n  //       <p>State: <span>{address.state}</span></p>\n  //       <p>Zip: <span>{address.zip}</span></p>\n  //       <p>Country: <span>{address.country}</span></p>\n  //     </div>\n\n  //   </div>\n  // </div>\n  ;\n}\n_s(Search, \"cuBdUCB/0arw8IRcReoU6gFz4vs=\");\n_c = Search;\nexport default Search;\nvar _c;\n$RefreshReg$(_c, \"Search\");","map":{"version":3,"names":["React","useEffect","useRef","useState","PlacesAutocomplete","geocodeByAddress","geocodeByPlaceId","getLatLng","apiKey","process","env","REACT_APP_GOOGLE_LOC_API_KEY","mapApiJs","geocodeJson","sessionToken","loadAsyncScript","src","Promise","resolve","script","document","createElement","Object","assign","type","async","addEventListener","head","appendChild","Search","initMapScript","window","google","then","setMapScriptLoaded","console","log","maps","places","AutocompleteSessionToken","address","setAddress","coordinates","setCoordinates","lat","lng","mapScriptLoaded","handleSelect","value","result","latLng","componentRestrictions","country","getInputProps","suggestions","getSuggestionItemProps","loading","refreshSessionToken","placeholder","map","suggestion","style","backgroundColor","active","description"],"sources":["/Users/bishnusukla/Documents/transportApp/v1/src/components/search/search.js"],"sourcesContent":["import React, {useEffect, useRef, useState} from 'react'\nimport './search.scss'\nimport PlacesAutocomplete, {\n    geocodeByAddress,\n    geocodeByPlaceId,\n    getLatLng,\n  } from 'react-places-autocomplete';\n\nconst apiKey = process.env.REACT_APP_GOOGLE_LOC_API_KEY;\nconst mapApiJs = 'https://maps.googleapis.com/maps/api/js';\nconst geocodeJson = 'https://maps.googleapis.com/maps/api/geocode/json';\n\nlet sessionToken = '';\n// load google map api js\n\nfunction loadAsyncScript(src) {\n  return new Promise(resolve => {\n    const script = document.createElement(\"script\");\n    Object.assign(script, {\n      type: \"text/javascript\",\n      async: true,\n      src\n    })\n    script.addEventListener(\"load\", () => resolve(script));\n    document.head.appendChild(script);\n  })\n}\n\n// const extractAddress = (place) => {\n\n//   const address = {\n//     city: \"\",\n//     state: \"\",\n//     zip: \"\",\n//     country: \"\",\n//     plain() {\n//       const city = this.city ? this.city + \", \" : \"\";\n//       const zip = this.zip ? this.zip + \", \" : \"\";\n//       const state = this.state ? this.state + \", \" : \"\";\n//       return city + zip + state + this.country;\n//     }\n//   }\n\n//   if (!Array.isArray(place?.address_components)) {\n//     return address;\n//   }\n\n//   place.address_components.forEach(component => {\n//     const types = component.types;\n//     const value = component.long_name;\n\n//     if (types.includes(\"locality\")) {\n//       address.city = value;\n//     }\n\n//     if (types.includes(\"administrative_area_level_2\")) {\n//       address.state = value;\n//     }\n\n//     if (types.includes(\"postal_code\")) {\n//       address.zip = value;\n//     }\n\n//     if (types.includes(\"country\")) {\n//       address.country = value;\n//     }\n\n//   });\n\n//   return address;\n// }\n\n\nfunction Search() {\n\n//   const searchInput = useRef(null);\n//   const [address, setAddress] = useState({});\n\n\n//   // init gmap script\n  const initMapScript = () => {\n    // if script already loaded\n    if(window.google) {\n      return Promise.resolve();\n    }\n    const src = `${mapApiJs}?key=${apiKey}&libraries=places&v=weekly&language=en&token=${sessionToken}&sessionToken=${sessionToken}&sessiontoken=${sessionToken}`;\n    return loadAsyncScript(src);\n  }\n\n//   // do something on address change\n//   const onChangeAddress = (autocomplete) => {\n//     const place = autocomplete.getPlace();\n//     setAddress(extractAddress(place));\n//   }\n\n//   // init autocomplete\n//   const initAutocomplete = () => {\n//     if (!searchInput.current) return;\n\n//     const autocomplete = new window.google.maps.places.Autocomplete(searchInput.current);\n//     autocomplete.setFields([\"address_component\", \"geometry\"]);\n//     autocomplete.addListener(\"place_changed\", () => onChangeAddress(autocomplete));\n\n//   }\n\n\n//   const reverseGeocode = ({ latitude: lat, longitude: lng}) => {\n//     const url = `${geocodeJson}?key=${apiKey}&latlng=${lat},${lng}`;\n//     searchInput.current.value = \"Getting your location...\";\n//     fetch(url)\n//         .then(response => response.json())\n//         .then(location => {\n//           const place = location.results[0];\n//           const _address = extractAddress(place);\n//           setAddress(_address);\n//           searchInput.current.value = _address.plain();\n//         })\n//   }\n\n\n//   const findMyLocation = () => {\n//     if (navigator.geolocation) {\n//       navigator.geolocation.getCurrentPosition(position => {\n//         reverseGeocode(position.coords)\n//       })\n//     }\n//   }\n\n\n\n\n\n  // load map script after mounted\n    useEffect(() => {\n        initMapScript().then(()=>{\n            setMapScriptLoaded(true);\n            console.log(\"google\",window.google);\n            sessionToken = new window.google.maps.places.AutocompleteSessionToken();\n            console.log(sessionToken);\n        })\n    }, []);\n\n    const [address, setAddress] = useState(\"\");\n    const [coordinates, setCoordinates] = useState({lat:null, lng:null});\n    const [mapScriptLoaded, setMapScriptLoaded] = useState(false);\n\n    const handleSelect = async(value) => {\n        sessionToken = new window.google.maps.places.AutocompleteSessionToken();\n        setAddress(value);\n        const result = await geocodeByAddress(value);\n        const latLng = await getLatLng(result[0]);\n        console.log(result[0]);\n        setCoordinates(latLng);\n    }\n\n  return (\n      <div>\n          {mapScriptLoaded && \n            <PlacesAutocomplete value={address} onChange={setAddress} onSelect={handleSelect} searchOptions={{componentRestrictions: { country: ['IN'] }}}>\n            {\n                ({getInputProps, suggestions, getSuggestionItemProps, loading, sessionToken, refreshSessionToken})=>(\n                    <div>\n                        <input {...getInputProps({placeholder: \"Type here\"})}/>\n\n                        <div>\n                            {loading?<div>...loading</div>:null}\n\n                            {suggestions.map(suggestion =>{\n                                const style = {\n                                    backgroundColor: suggestion.active? \"#41b6e6\" : \"#fff\"\n                                }\n                                return <div {...getSuggestionItemProps(suggestion, {style})}>\n                                    {suggestion.description}\n                                </div>\n                            })}\n                        </div>\n                    </div>\n                )\n            }\n            </PlacesAutocomplete>\n          }\n      </div>\n    // <div className=\"App\">\n    //   <div>\n    //     <div className=\"search\">\n    //       <span>S</span>\n    //       <input ref={searchInput} type=\"text\" placeholder=\"Search location....\"/>\n    //       <button onClick={findMyLocation}>L</button>\n    //     </div>\n\n    //     <div className=\"address\">\n    //       <p>City: <span>{address.city}</span></p>\n    //       <p>State: <span>{address.state}</span></p>\n    //       <p>Zip: <span>{address.zip}</span></p>\n    //       <p>Country: <span>{address.country}</span></p>\n    //     </div>\n\n    //   </div>\n    // </div>\n  )\n}\n\nexport default Search"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}